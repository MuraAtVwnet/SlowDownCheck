
■ これは何 ?
メモリー不足でスローダウンが起きているか否かを確認します。

■ 実行方法
PowerShell プロンプトを開いて、以下コマンドを入力します。

    ~\SlowDownCheck.ps1 -RecordLog

■ 終了方法と計測結果
計測を終了する場合は、「Ctrl + C」します。

-RecordLog オプションを指定すると、カレントディレクトリにログ(SlowDownCheck_YYYY-MM-DD.log)が出力されるので、後から計測結果を確認できます。

カレントディレクトリを開くには、以下コマンドを入力します。

    ii .

■ 解説
5秒毎にパフォーマンスカウンターから以下の値を取って状態判定しています

・ページング(\Memory\Pages/sec)
    「(P)」 と表示されています。
    この単体値が 5 を超える場合、メモリがボトルネックになっています(メモリー不足状態)

    閾値を超えた場合は「過剰ページング」と表示します。


・ディスク速度(\PhysicalDisk(0 c:)\Avg. Disk sec/Transfer)
    ページファイがあるディスクの転送速度
    ページング速度を計測するための値です
    「(D)」 と表示されています。

・ページ処理のディスク アクセス タイム割合
    ページング * ディスク速度

    この値が 0.1 を超える場合は、ページ処理がディスク アクセス タイムの 10% より多くの時間がかかり、著しくパフォーマンスダウンしている状態になっています。

    閾値を超えた場合は「著しいスローダウン」と表示されます。


